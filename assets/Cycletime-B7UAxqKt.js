import{i as W,u as g,w as N}from"./xlsx-CWhwR8kk.js";import{_ as R,V as b,a as z}from"./VMenu-B-BUlR1w.js";import{V as j,b as p,a as P}from"./VSheet-C97c62Ri.js";import{F as S,i as E,G,T as H,S as q}from"./VTextField-CrbyiZd-.js";import{r as d,f as x,w as J,o as K,a3 as Q,a4 as X,a5 as Y,a6 as n,c as o,y as D,an as k,a8 as C,ac as Z}from"./index-Bkqyg1YU.js";import"./VOverlay-BwOvpMLK.js";const ee={__name:"Cycletime",props:{modelValue:{type:String,default:""},labelDate:{type:String,default:"Select Date"},labelStartTime:{type:String,default:"Select Start Time"},labelEndTime:{type:String,default:"Select End Time"}},emits:["update:modelValue"],setup(f,{emit:L}){const w=d(null),_=f,v=L,y=d(!1),V=d(!1),T=d(!1),r=d(_.modelValue||new Date().toISOString().split("T")[0]),s=d("08:00"),m=d("17:00"),h=x(()=>r.value?new Date(r.value).toLocaleDateString():""),M=x(()=>s.value?s.value:""),I=x(()=>m.value?m.value:""),U=e=>{v("update:modelValue",e),y.value=!1,r.value=e},F=e=>{v("update:modelValue",e),V.value=!1,s.value=e},A=e=>{v("update:modelValue",e),T.value=!1,m.value=e},$=()=>{console.log("Date:",r.value),console.log("Start Time:",s.value),console.log("End Time:",m.value)};J(()=>_.modelValue,e=>{r.value=e||new Date().toISOString().split("T")[0],s.value=e?new Date(e).toTimeString().substring(0,5):"08:00",m.value=e?new Date(e).toTimeString().substring(0,5):"17:00"});const c=d((()=>{const e=[];let t=0;for(let a=0;a<20;a++){const l=Math.floor(Math.random()*100)+100,i=Math.floor(Math.random()*100)+100,u=Math.floor(Math.random()*100)+10;t+=(l+i+u)/60,e.push({time:t.toFixed(2),productionTime:l,cycleTime:i,interval:u})}return e})()),B=c.value.map(e=>e.interval);K(()=>{const e=W(w.value),t={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:a=>{const l=B[a[0].dataIndex];return`${a[0].axisValue}<br/>Production Time: ${a[0].data} sec<br/>Waiting Time: ${a[1].data} sec<br/>Interval: ${l} sec`}},legend:{data:["Production Time","Waiting Time"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",name:"(min)",data:c.value.map(a=>a.time),axisLabel:{formatter:function(a){return`${a}`}}},yAxis:{type:"value",name:"(sec)",min:0,max:500},series:[{name:"Production Time",type:"bar",stack:"Total",emphasis:{focus:"series"},data:c.value.map(a=>a.productionTime),itemStyle:{color:"#5470C6"}},{name:"Waiting Time",type:"bar",stack:"Total",emphasis:{focus:"series"},data:c.value.map(a=>a.cycleTime),itemStyle:{color:"#d1d1d1"},markLine:{data:[{type:"average",name:"Avg"}],lineStyle:{type:"dashed",color:"#FF0000",width:1}}},{name:"Line Indicator",type:"line",data:c.value.map(a=>a.cycleTime+a.productionTime),lineStyle:{type:"solid",width:1,color:"blue"}}],markLine:{symbol:"none",data:[{name:"Limit",yAxis:320,lineStyle:{type:"dashed",color:"#FF0000",width:1},label:{position:"end",formatter:"Limit 320 sec"}}]}};e.setOption(t),window.addEventListener("resize",()=>{e.resize()})});const O=()=>{const e=c.value.map(a=>({Time:a.time,"Production Time":a.productionTime,"Waiting Time":a.cycleTime,Interval:a.interval})),t=g.book_new();g.book_append_sheet(t,g.json_to_sheet(e),"Production Data"),N(t,"ProductionData.xlsx")};return(e,t)=>{const a=Q("v-time-picker");return X(),Y(j,null,{default:n(()=>[o(P,null,{default:n(()=>[o(p,{cols:"12",md:"3"},{default:n(()=>[o(b,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=l=>y.value=l),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:n(({on:l,attrs:i})=>[o(S,D({modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=u=>h.value=u),label:f.labelDate,readonly:""},i,k(l),{variant:"outlined"}),null,16,["modelValue","label"])]),default:n(()=>[o(z,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=l=>r.value=l),onInput:U,format:"yyyy-MM-dd"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),o(p,{cols:"12",md:"3"},{default:n(()=>[o(b,{modelValue:V.value,"onUpdate:modelValue":t[5]||(t[5]=l=>V.value=l),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:n(({on:l,attrs:i})=>[o(S,D({modelValue:M.value,"onUpdate:modelValue":t[3]||(t[3]=u=>M.value=u),label:f.labelStartTime,readonly:""},i,k(l),{variant:"outlined"}),null,16,["modelValue","label"])]),default:n(()=>[o(a,{modelValue:s.value,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value=l),onInput:F,format:"24hr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),o(p,{cols:"12",md:"3"},{default:n(()=>[o(b,{modelValue:T.value,"onUpdate:modelValue":t[8]||(t[8]=l=>T.value=l),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:n(({on:l,attrs:i})=>[o(S,D({modelValue:I.value,"onUpdate:modelValue":t[6]||(t[6]=u=>I.value=u),label:f.labelEndTime,readonly:""},i,k(l),{variant:"outlined"}),null,16,["modelValue","label"])]),default:n(()=>[o(a,{modelValue:m.value,"onUpdate:modelValue":t[7]||(t[7]=l=>m.value=l),onInput:A,format:"24hr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),o(p,{cols:"12",md:"3"},{default:n(()=>[o(E,{onClick:$,color:"primary"},{default:n(()=>[C("Apply")]),_:1}),o(E,{onClick:O,color:"green",class:"ml-2"},{default:n(()=>[C("Download Excel")]),_:1})]),_:1})]),_:1}),o(P,null,{default:n(()=>[o(p,{cols:"12"},{default:n(()=>[o(G,null,{default:n(()=>[o(H,{class:"card-title"},{default:n(()=>[C("Production Cycle")]),_:1}),o(q,null,{default:n(()=>[Z("div",{ref_key:"productionChart",ref:w,style:{width:"100%",height:"500px"}},null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},de=R(ee,[["__scopeId","data-v-3c20d7b6"]]);export{de as default};
